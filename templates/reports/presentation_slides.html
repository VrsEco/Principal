<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slides de Apresenta√ß√£o - {{ plan.name }}</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}" />
    <link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}" />
    <style>
        @page {
            size: A4 landscape;
            margin: 1.5cm;
        }
        
        @media print {
            @page {
                size: A4 landscape;
                margin: 1.5cm;
            }
        }
        
        body {
            font-family: 'Poppins', 'Arial', sans-serif;
            line-height: 1.4;
            color: #1a1a1a;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            max-width: 29.7cm;
            margin: 0 auto;
        }
        
        @media print {
            body {
                max-width: none;
                margin: 0;
                background: white;
            }
        }
        
        .slide {
            width: 100%;
            min-height: 100vh;
            background: white;
            margin: 0 0 20px 0;
            padding: 40px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: center;
            page-break-after: always;
        }
        
        @media print {
            .slide {
                width: 100%;
                height: 100vh;
                margin: 0;
                padding: 1.5cm;
                page-break-after: always;
            }
            
            .slide:last-child {
                page-break-after: avoid;
            }
            
            * {
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
        }
        
        .slide:last-child {
            page-break-after: avoid;
        }
        
        .slide-title {
            font-size: 32px;
            font-weight: 700;
            color: #1a1a1a;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 4px solid #39f2ae;
            padding-bottom: 15px;
            letter-spacing: -0.5px;
        }
        
        .slide-subtitle {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
            margin: 25px 0 15px 0;
            letter-spacing: -0.3px;
        }
        
        .slide-content {
            font-size: 18px;
            line-height: 1.6;
            text-align: justify;
        }
        
        .slide-content.center {
            text-align: center;
        }
        
        .cover-slide {
            background: linear-gradient(135deg, #39f2ae 0%, #2dd4bf 50%, #06b6d4 100%);
            color: white;
            text-align: center;
            position: relative;
        }
        
        
        .cover-slide > * {
            position: relative;
            z-index: 2;
        }
        
        .cover-slide .slide-title {
            font-size: 48px;
            color: white;
            border-bottom: 3px solid white;
        }
        
        .cover-slide .slide-subtitle {
            font-size: 28px;
            color: #e8f4f8;
        }
        
        .cover-slide .slide-content {
            font-size: 20px;
            color: #e8f4f8;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-item {
            background: linear-gradient(135deg, rgba(57, 242, 174, 0.08), rgba(57, 242, 174, 0.02));
            border: 2px solid #39f2ae;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(57, 242, 174, 0.15);
        }
        
        .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: #39f2ae;
            display: block;
        }
        
        .stat-label {
            font-size: 16px;
            color: #6c757d;
            margin-top: 5px;
        }
        
        .okr-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .okr-card {
            background: linear-gradient(135deg, rgba(57, 242, 174, 0.06), rgba(255, 255, 255, 0.8));
            border: 1px solid rgba(57, 242, 174, 0.3);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(57, 242, 174, 0.1);
        }
        
        .okr-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .okr-meta {
            font-size: 14px;
            color: #6c757d;
            margin: 5px 0;
        }
        
        .key-results {
            margin: 10px 0 0 0;
        }
        
        .key-result-item {
            font-size: 14px;
            margin: 3px 0;
        }
        
        .project-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .project-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
        }
        
        .project-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .project-meta {
            font-size: 14px;
            color: #6c757d;
            margin: 3px 0;
        }
        
        .analysis-box {
            background: linear-gradient(135deg, rgba(57, 242, 174, 0.08), rgba(57, 242, 174, 0.02));
            border-left: 5px solid #39f2ae;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(57, 242, 174, 0.1);
        }
        
        .bullet-points {
            margin: 15px 0;
        }
        
        .bullet-points li {
            margin: 8px 0;
            font-size: 16px;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, rgba(57, 242, 174, 0.1), rgba(57, 242, 174, 0.03));
            border: 1px solid rgba(57, 242, 174, 0.4);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 12px rgba(57, 242, 174, 0.15);
        }
        
        .highlight-box h4 {
            color: #1a1a1a;
            margin: 0 0 10px 0;
            font-weight: 600;
        }
        
        .highlight-box p {
            color: #2c3e50;
            margin: 0;
        }
        
        .footer-slide {
            background: linear-gradient(135deg, #1a1a1a 0%, #2c3e50 100%);
            color: white;
            text-align: center;
            position: relative;
        }
        
        
        .footer-slide > * {
            position: relative;
            z-index: 2;
        }
        
        .footer-slide .slide-title {
            color: white;
            border-bottom: 3px solid white;
        }
        
        .contact-info {
            font-size: 18px;
            margin: 20px 0;
        }
        
        .slide-number {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #39f2ae, #2dd4bf);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(57, 242, 174, 0.3);
        }
        
        .icon-ai, .icon-consultant, .icon-chart, .icon-analysis {
            display: inline-block;
            margin-right: 8px;
            font-size: 1.2em;
            color: #39f2ae;
        }
        
        .directionals-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .directional-card {
            background: linear-gradient(135deg, rgba(57, 242, 174, 0.08), rgba(255, 255, 255, 0.9));
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #39f2ae;
            box-shadow: 0 4px 12px rgba(57, 242, 174, 0.1);
        }
        
        .directional-card h4 {
            color: #1a1a1a;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        
        .directional-card p {
            color: #4a4a4a;
            line-height: 1.5;
            margin-bottom: 12px;
        }
        
        .directional-type {
            display: inline-block;
            background: linear-gradient(135deg, #39f2ae, #2dd4bf);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
    </style>
</head>
<body>
    <!-- Slide 1: Capa -->
    <div class="slide cover-slide">
        <div style="text-align: center; margin-bottom: 40px; z-index: 3;">
            <img src="/static/img/logo-pev.png" alt="Versus Gest√£o Corporativa" style="height: 200px; width: auto; margin: 0 auto;">
        </div>
        <h1 class="slide-title">Planejamento Estrat√©gico</h1>
        <h2 class="slide-subtitle">{{ plan.name }}</h2>
        <div class="slide-content center">
            <p>{{ company.name }}</p>
            <p>{{ plan.created_at.strftime('%B de %Y') if plan.created_at else '2024' }}</p>
        </div>
        <div class="slide-number">1</div>
    </div>

    <!-- Slide 2: Resumo Executivo -->
    <div class="slide">
        <h1 class="slide-title">Resumo Executivo</h1>
        <div class="slide-content">
            <p>Este processo de planejamento estrat√©gico foi desenvolvido para {{ company.name }}, 
            combinando an√°lise de intelig√™ncia artificial com expertise consultiva especializada.</p>
            
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-number">{{ sections_data.okr_global.workshop|length + sections_data.okr_global.approvals|length }}</span>
                    <div class="stat-label">OKRs Globais</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">{{ sections_data.projects.projects|length if sections_data.projects.projects else 0 }}</span>
                    <div class="stat-label">Projetos Estrat√©gicos</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">100%</span>
                    <div class="stat-label">Metodologia Aplicada</div>
                </div>
            </div>
            
            <div class="highlight-box">
                <h4>Principais Resultados</h4>
                <p>Defini√ß√£o clara de direcionadores estrat√©gicos, OKRs mensur√°veis e projetos 
                execut√°veis que viabilizam a implementa√ß√£o da estrat√©gia organizacional.</p>
            </div>
        </div>
        <div class="slide-number">2</div>
    </div>

    <!-- Slide 3: Direcionadores Estrat√©gicos -->
    <div class="slide">
        <h1 class="slide-title">Direcionadores Estrat√©gicos</h1>
        <div class="slide-content">
            <h2 class="slide-subtitle">An√°lise e Defini√ß√£o</h2>
            
            {% if sections_data.directionals.ai_analysis %}
            <div class="analysis-box">
                <h4><span class="icon-ai">‚öô</span> An√°lise de Intelig√™ncia Artificial</h4>
                <p>{{ sections_data.directionals.ai_analysis[:200] }}{% if sections_data.directionals.ai_analysis|length > 200 %}...{% endif %}</p>
            </div>
            {% endif %}
            
            {% if sections_data.directionals.consultant_analysis %}
            <div class="analysis-box">
                <h4><span class="icon-consultant">‚úé</span> An√°lise do Consultor</h4>
                <p>{{ sections_data.directionals.consultant_analysis[:200] }}{% if sections_data.directionals.consultant_analysis|length > 200 %}...{% endif %}</p>
            </div>
            {% endif %}
            
            {% if sections_data.directionals.approvals %}
            <div class="analysis-box">
                <h4><span class="icon-analysis">üìã</span> Aprova√ß√µes e Decis√µes</h4>
                <p>{{ sections_data.directionals.approvals[:200] }}{% if sections_data.directionals.approvals|length > 200 %}...{% endif %}</p>
            </div>
            {% endif %}
            
            {% if not sections_data.directionals.ai_analysis and not sections_data.directionals.consultant_analysis and not sections_data.directionals.approvals %}
            <div class="bullet-points">
                <ul>
                    <li>An√°lise do ambiente interno e externo</li>
                    <li>Identifica√ß√£o de oportunidades e amea√ßas</li>
                    <li>Defini√ß√£o de direcionadores estrat√©gicos</li>
                    <li>Alinhamento com a vis√£o organizacional</li>
                </ul>
            </div>
            {% endif %}
        </div>
        <div class="slide-number">3</div>
    </div>

    <!-- Slide 4: OKRs Globais -->
    <div class="slide">
        <h1 class="slide-title">OKRs Globais</h1>
        <div class="slide-content">
            <h2 class="slide-subtitle">Objetivos e Resultados-Chave</h2>
            
            {% if sections_data.okr_global.workshop or sections_data.okr_global.approvals %}
            <div class="okr-grid">
                {% for okr in (sections_data.okr_global.workshop + sections_data.okr_global.approvals) %}
                <div class="okr-card">
                    <div class="okr-title">{{ okr.objective or 'OKR Global' }}</div>
                    <div class="okr-meta">Tipo: {{ okr.type or 'Geral' }}</div>
                    {% if okr.owner %}<div class="okr-meta">Respons√°vel: {{ okr.owner }}</div>{% endif %}
                    {% if okr.deadline %}<div class="okr-meta">Prazo: {{ okr.deadline.strftime('%d/%m/%Y') if okr.deadline.strftime is defined else okr.deadline }}</div>{% endif %}
                    {% if okr.key_results %}
                    <div class="key-results">
                        <strong>Key Results:</strong>
                        {% for kr in okr.key_results[:2] %}
                        <div class="key-result-item">‚Ä¢ {{ kr.label }}{% if kr.target %} - {{ kr.target }}{% endif %}</div>
                        {% endfor %}
                        {% if okr.key_results|length > 2 %}
                        <div class="key-result-item">‚Ä¢ ... e mais {{ okr.key_results|length - 2 }} KR(s)</div>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="highlight-box">
                <h4>OKRs em Desenvolvimento</h4>
                <p>Os OKRs globais est√£o sendo desenvolvidos com base nos direcionadores estrat√©gicos definidos.</p>
            </div>
            {% endif %}
        </div>
        <div class="slide-number">4</div>
    </div>

    <!-- Slide 5: OKRs de √Årea -->
    <div class="slide">
        <h1 class="slide-title">OKRs de √Årea</h1>
        <div class="slide-content">
            <h2 class="slide-subtitle">Desdobramento por √Årea</h2>
            
            {% if sections_data.okr_area.workshop or sections_data.okr_area.final %}
            <div class="analysis-box">
                <h4><span class="icon-chart">üìä</span> Status dos OKRs de √Årea</h4>
                <p>OKRs de √°rea foram desenvolvidos para garantir o alinhamento entre os objetivos globais 
                e as a√ß√µes espec√≠ficas de cada √°rea organizacional.</p>
            </div>
            
            <div class="bullet-points">
                <ul>
                    <li>Desdobramento dos OKRs globais por √°rea</li>
                    <li>Alinhamento com as responsabilidades departamentais</li>
                    <li>M√©tricas espec√≠ficas por √°rea de atua√ß√£o</li>
                    <li>Integra√ß√£o com os projetos estrat√©gicos</li>
                </ul>
            </div>
            {% else %}
            <div class="highlight-box">
                <h4>OKRs de √Årea em Desenvolvimento</h4>
                <p>Os OKRs de √°rea ser√£o desenvolvidos com base nos OKRs globais aprovados.</p>
            </div>
            {% endif %}
        </div>
        <div class="slide-number">5</div>
    </div>

    <!-- Slide 6: Projetos Estrat√©gicos -->
    <div class="slide">
        <h1 class="slide-title">Projetos Estrat√©gicos</h1>
        <div class="slide-content">
            <h2 class="slide-subtitle">Iniciativas de Execu√ß√£o</h2>
            
            {% if sections_data.projects.projects %}
            <div class="project-grid">
                {% for project in sections_data.projects.projects %}
                <div class="project-card">
                    <div class="project-title">{{ project.title }}</div>
                    {% if project.owner %}<div class="project-meta">Respons√°vel: {{ project.owner }}</div>{% endif %}
                    {% if project.status %}<div class="project-meta">Status: {{ project.status }}</div>{% endif %}
                    {% if project.priority %}<div class="project-meta">Prioridade: {{ project.priority }}</div>{% endif %}
                    {% if project.description %}<div class="project-meta">{{ project.description[:100] }}{% if project.description|length > 100 %}...{% endif %}</div>{% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="highlight-box">
                <h4>Projetos em Desenvolvimento</h4>
                <p>Os projetos estrat√©gicos ser√£o definidos com base nos OKRs aprovados.</p>
            </div>
            {% endif %}
            
            {% if sections_data.projects.analysis %}
            <div class="analysis-box">
                <h4><span class="icon-analysis">üìà</span> An√°lise de Projetos</h4>
                <p>{{ sections_data.projects.analysis[:200] }}{% if sections_data.projects.analysis|length > 200 %}...{% endif %}</p>
            </div>
            {% endif %}
        </div>
        <div class="slide-number">6</div>
    </div>

    <!-- Slide 7: Pr√≥ximos Passos -->
    <div class="slide">
        <h1 class="slide-title">Pr√≥ximos Passos</h1>
        <div class="slide-content">
            <h2 class="slide-subtitle">Implementa√ß√£o da Estrat√©gia</h2>
            
            <div class="bullet-points">
                <ul>
                    <li><strong>Implementa√ß√£o Imediata:</strong> In√≠cio dos projetos estrat√©gicos priorit√°rios</li>
                    <li><strong>Monitoramento:</strong> Acompanhamento regular dos OKRs estabelecidos</li>
                    <li><strong>Revis√£o Peri√≥dica:</strong> Avalia√ß√£o trimestral dos resultados</li>
                    <li><strong>Ajustes Estrat√©gicos:</strong> Adapta√ß√£o √†s mudan√ßas do mercado</li>
                </ul>
            </div>
            
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-number">30</span>
                    <div class="stat-label">Dias para In√≠cio</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">90</span>
                    <div class="stat-label">Dias para Primeira Revis√£o</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">365</span>
                    <div class="stat-label">Dias para Avalia√ß√£o Completa</div>
                </div>
            </div>
            
            <div class="highlight-box">
                <h4>Suporte Cont√≠nuo</h4>
                <p>Acompanhamento e suporte ser√£o fornecidos durante todo o processo de implementa√ß√£o.</p>
            </div>
        </div>
        <div class="slide-number">7</div>
    </div>

    <!-- Slide 8: Contato -->
    <div class="slide footer-slide">
        <div style="position: absolute; top: 40px; left: 40px; z-index: 3;">
            <img src="/static/img/logo-pev.png" alt="Versus Gest√£o Corporativa" style="height: 60px; width: auto;">
        </div>
        <h1 class="slide-title">Obrigado!</h1>
        <div class="slide-content center">
            <div class="contact-info">
                <p><strong>Versus Gest√£o Corporativa</strong></p>
                <p>Planejamento Estrat√©gico - {{ company.name }}</p>
                <p>{{ plan.created_at.strftime('%B de %Y') if plan.created_at else '2024' }}</p>
            </div>
            
            <div class="highlight-box" style="background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.3);">
                <h4 style="color: white;">Contato para Suporte</h4>
                <p style="color: white;">Estamos dispon√≠veis para esclarecer d√∫vidas e fornecer suporte durante a implementa√ß√£o.</p>
            </div>
        </div>
        <div style="position: absolute; bottom: 40px; right: 40px; z-index: 3;">
            <p style="font-size: 12px; opacity: 0.8;">Versus Gest√£o Corporativa - Transformando Estrat√©gias em Resultados</p>
        </div>
        <div class="slide-number">8</div>
    </div>
</body>
</html>

