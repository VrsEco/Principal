{
  "meta": {
    "project": "GestaoVersus",
    "date": "2025-11-04",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "GestaoVersus é uma plataforma modular de gestão empresarial construída em Flask, que integra planejamento estratégico, gestão de resultados, reuniões e controle de tarefas individuais com foco na simplificação e auditoria completa das operações.",
  "core_goals": [
    "Fornecer uma solução integrada para gestão estratégica e operacional empresarial.",
    "Garantir segurança e controle de acesso robusto via autenticação e sessões protegidas.",
    "Implementar auditoria automática e detalhada de todas as operações CRUD e acessos relevantes.",
    "Oferecer módulos especializados para planejamento financeiro, gestão de projetos, reuniões e tarefas pessoais.",
    "Disponibilizar visualização, filtros e análises avançadas para logs e auditorias de uso.",
    "Manter compatibilidade ampla entre PostgreSQL e SQLite para ambientes de produção e desenvolvimento."
  ],
  "key_features": [
    "Módulo PEV para implantação de planos estratégicos e modelagem financeira ModeFin com 8 seções funcionais detalhadas.",
    "Módulo GRV para gestão de portfólios, projetos, indicadores e processos empresariais.",
    "Módulo Meetings para agendamento, acompanhamento e exportação de reuniões, pautas e atas.",
    "Módulo My Work para gerenciamento individual de tarefas e checklists vinculados a planos e OKRs.",
    "Sistema de autenticação completo com registro, login, logout, recuperação e alteração de senha.",
    "API e interface para consulta e exportação de logs de usuários com paginação e filtros seguros.",
    "API administrativa para auditoria de rotas, habilitação de logging e monitoração de cobertura.",
    "Auditoria automática e transparente com registro detalhado em user_logs de todas ações sensíveis.",
    "Interface baseada em Flask com templates Jinja2, modais padrão para CRUD e navegação fluida.",
    "Suporte a segurança de sessão via cookies e gerenciamento de perfil via Flask-Login."
  ],
  "user_flow_summary": [
    "Usuário acessa tela de login para autenticação, podendo criar conta ou recuperar senha.",
    "Após login, redirecionamento ao dashboard principal, inicialmente no módulo PEV para seleção ou visualização do plano.",
    "Navegação por módulos: PEV para implantação e finanças, GRV para gestão de resultados, Meetings para controle de reuniões e My Work para tarefas pessoais.",
    "No PEV, o usuário navega por seções ModeFin para inserção, edição e análise financeira avançada, com visualização dinâmica de projeções.",
    "No GRV, usuários criam e gerenciam projetos, portfólios e indicadores OKR com histórico e avaliações.",
    "Reuniões são cadastradas com agenda, pauta, participação e atas, possibilitando geração de relatórios PDF.",
    "Todas as operações CRUD acionam auditoria automática com logs detalhados para segurança e rastreabilidade.",
    "Usuários com permissões específicas podem acessar APIs administrativas para controle e monitoramento do sistema de auditoria."
  ],
  "validation_criteria": [
    "Toda funcionalidade protegida por autenticação requer sessão válida; falhas redirecionam ao login.",
    "Todas operações CRUD possuem logs automáticos que registram ação, usuário, timestamp e dados impactados.",
    "As visualizações e listagens implementam paginação para desempenho consistente com grandes volumes.",
    "O módulo ModeFin valida regras de negócio como destinações percentuais condicionais e projeções de 60 meses.",
    "Testes de casos reais com criação, atualização e exclusão garantem persistência e consistência dos dados financeiros e projetos.",
    "APIs respondem com padrões claros JSON, códigos HTTP adequados e mensagens de erro úteis.",
    "Auditoria de rotas e logging pode ser habilitada/desabilitada via interface admin, garantindo cobertura e segurança.",
    "Interfaces utilizam padrão modal segundo governança UX para abertura, fechamento e scroll, conforme especificações.",
    "Carga e exportação de reuniões geram documentos consistentes, testados com Playwright onde aplicável.",
    "Permissões diferenciadas para perfis admin, consultant e client garantem segurança de acesso, testadas via casos de permissão."
  ],
  "code_summary": {
    "tech_stack": [
      "Python 3.9+",
      "Flask 2.3.3",
      "SQLAlchemy 2.0",
      "PostgreSQL",
      "SQLite",
      "Jinja2",
      "Vanilla JavaScript",
      "Celery",
      "Redis (opcional)"
    ],
    "features": [
      {
        "name": "Authentication API",
        "description": "Endpoints para autenticação, encerramento de sessão, registro e gestão de perfil protegidos por Flask-Login.",
        "files": [
          "api/auth.py",
          "services/auth_service.py",
          "models/user.py",
          "templates/auth/login.html"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Authentication API",
            "version": "1.0.0"
          },
          "paths": {
            "/auth/login": {
              "post": {
                "summary": "Autentica usuário",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "email": {
                            "type": "string",
                            "format": "email"
                          },
                          "password": {
                            "type": "string",
                            "format": "password"
                          },
                          "remember": {
                            "type": "boolean"
                          }
                        },
                        "required": [
                          "email",
                          "password"
                        ]
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Login realizado",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "success": {
                              "type": "boolean"
                            },
                            "message": {
                              "type": "string"
                            },
                            "user": {
                              "type": "object"
                            }
                          }
                        }
                      }
                    }
                  },
                  "400": {
                    "description": "Dados inválidos"
                  },
                  "401": {
                    "description": "Credenciais incorretas"
                  }
                }
              }
            },
            "/auth/logout": {
              "post": {
                "summary": "Encerra sessão",
                "responses": {
                  "200": {
                    "description": "Logout realizado"
                  },
                  "500": {
                    "description": "Erro interno"
                  }
                },
                "security": [
                  {
                    "sessionAuth": []
                  }
                ]
              }
            },
            "/auth/register": {
              "post": {
                "summary": "Cria usuário",
                "responses": {
                  "200": {
                    "description": "Usuário criado"
                  },
                  "400": {
                    "description": "Dados inválidos"
                  },
                  "403": {
                    "description": "Acesso negado"
                  }
                },
                "security": [
                  {
                    "sessionAuth": []
                  }
                ]
              }
            },
            "/auth/change-password": {
              "post": {
                "summary": "Atualiza senha",
                "responses": {
                  "200": {
                    "description": "Senha atualizada"
                  },
                  "400": {
                    "description": "Validação falhou"
                  },
                  "401": {
                    "description": "Não autenticado"
                  }
                },
                "security": [
                  {
                    "sessionAuth": []
                  }
                ]
              }
            }
          },
          "components": {
            "securitySchemes": {
              "sessionAuth": {
                "type": "apiKey",
                "in": "cookie",
                "name": "session"
              }
            }
          }
        }
      },
      {
        "name": "User Logs API",
        "description": "Consultas, estatísticas e exportação de logs de usuários com paginação obrigatória e escopos seguros.",
        "files": [
          "api/logs.py",
          "services/log_service.py",
          "models/log_entry.py",
          "templates/logs/dashboard.html"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "User Logs API",
            "version": "1.0.0"
          },
          "paths": {
            "/logs/": {
              "get": {
                "summary": "Lista logs com filtros",
                "parameters": [
                  {
                    "name": "entity_type",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "action",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "user_id",
                    "in": "query",
                    "schema": {
                      "type": "integer"
                    }
                  },
                  {
                    "name": "company_id",
                    "in": "query",
                    "schema": {
                      "type": "integer"
                    }
                  },
                  {
                    "name": "limit",
                    "in": "query",
                    "schema": {
                      "type": "integer",
                      "default": 50
                    }
                  },
                  {
                    "name": "offset",
                    "in": "query",
                    "schema": {
                      "type": "integer",
                      "default": 0
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Lista de logs",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "success": {
                              "type": "boolean"
                            },
                            "logs": {
                              "type": "array",
                              "items": {
                                "type": "object"
                              }
                            },
                            "pagination": {
                              "type": "object"
                            }
                          }
                        }
                      }
                    }
                  },
                  "500": {
                    "description": "Erro interno"
                  }
                },
                "security": [
                  {
                    "sessionAuth": []
                  }
                ]
              }
            },
            "/logs/stats": {
              "get": {
                "summary": "Estatísticas de logs",
                "parameters": [
                  {
                    "name": "company_id",
                    "in": "query",
                    "schema": {
                      "type": "integer"
                    }
                  },
                  {
                    "name": "days",
                    "in": "query",
                    "schema": {
                      "type": "integer",
                      "default": 30
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Estatísticas retornadas"
                  },
                  "500": {
                    "description": "Erro interno"
                  }
                },
                "security": [
                  {
                    "sessionAuth": []
                  }
                ]
              }
            },
            "/logs/entity-activity/{entity_type}/{entity_id}": {
              "get": {
                "summary": "Atividade por entidade",
                "parameters": [
                  {
                    "name": "entity_type",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  },
                  {
                    "name": "entity_id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Logs da entidade"
                  },
                  "404": {
                    "description": "Entidade não encontrada"
                  },
                  "500": {
                    "description": "Erro interno"
                  }
                },
                "security": [
                  {
                    "sessionAuth": []
                  }
                ]
              }
            }
          },
          "components": {
            "securitySchemes": {
              "sessionAuth": {
                "type": "apiKey",
                "in": "cookie",
                "name": "session"
              }
            }
          }
        }
      },
      {
        "name": "Route Audit API",
        "description": "APIs administrativas para auditar rotas registradas, habilitar e desabilitar auto logging e revisar lacunas de cobertura.",
        "files": [
          "api/route_audit.py",
          "services/route_audit_service.py",
          "middleware/auto_log_decorator.py",
          "templates/route_audit/dashboard.html"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Route Audit API",
            "version": "1.0.0"
          },
          "paths": {
            "/route-audit/api/summary": {
              "get": {
                "summary": "Resumo da auditoria",
                "responses": {
                  "200": {
                    "description": "Resumo retornado"
                  },
                  "403": {
                    "description": "Acesso negado"
                  },
                  "500": {
                    "description": "Erro interno"
                  }
                },
                "security": [
                  {
                    "sessionAuth": []
                  }
                ]
              }
            },
            "/route-audit/api/routes": {
              "get": {
                "summary": "Lista de rotas",
                "parameters": [
                  {
                    "name": "filter",
                    "in": "query",
                    "schema": {
                      "type": "string",
                      "enum": [
                        "all",
                        "with_logging",
                        "without_logging",
                        "crud"
                      ],
                      "default": "all"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Rotas retornadas"
                  },
                  "403": {
                    "description": "Acesso negado"
                  },
                  "500": {
                    "description": "Erro interno"
                  }
                },
                "security": [
                  {
                    "sessionAuth": []
                  }
                ]
              }
            },
            "/route-audit/api/entity/{entity_type}/enable": {
              "post": {
                "summary": "Habilita auto logging",
                "parameters": [
                  {
                    "name": "entity_type",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Logging habilitado"
                  },
                  "403": {
                    "description": "Acesso negado"
                  },
                  "500": {
                    "description": "Erro interno"
                  }
                },
                "security": [
                  {
                    "sessionAuth": []
                  }
                ]
              }
            }
          },
          "components": {
            "securitySchemes": {
              "sessionAuth": {
                "type": "apiKey",
                "in": "cookie",
                "name": "session"
              }
            }
          }
        }
      }
    ]
  }
}
